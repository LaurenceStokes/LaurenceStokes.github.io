---
layout: post
title: Deobfuscating Javascript Code
---

In software development, obfuscation is the intentional structuring of code to make it difficult to interpret by humans. Typically, this is done to prevent reverse engineering or to conceal the purpose of the code, which is known as __security through obscurity.__ Many malicious malware binaries obfuscate their code to this end – as do javascript malware exploits, which use javascript and the users browser as their delivery mechanism. Not only does obfuscation render reverse-engineering the malware harder, it also makes it more likely to bypass virus scanners. The virus scanner might be looking for certain signatures (evidence of shellcode payloads, for example) that may go unnoticed if the malware is sufficiently obfuscated.

In this blog post I am going to go through and deobfuscate some javascript code, courtesy of [www.scumware.org](www.scumware.org), a website dedicated to malware analysis and research.

Although a contrived example (you would never see a password checker like this in ‘real-life’), the basic principles and step-by-step processes remain the same. In fact, I like the scumware.org series of challenges and feel they present a nice introduction to javascript deobfuscation. Finding a password also provides a nice ‘end goal’ to each challenge!

Anyway, with that long preamble aside, let’s jump right into the challenge, which can be found at: [http://www.scumware.org/skill_up/WarmUp_lvl1.scumware](http://www.scumware.org/skill_up/WarmUp_lvl1.scumware)

On loading the webpage, you will be presented with a input form and a password check. First things first, let’s view source. (right click the page: view page source)!

![scumwarePart1](../images/scumwarePart1.png)

```javascript
var paper = document;
var domain = paper.domain.length;
var flog = eval;
var VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV = new Array;
VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV[0] = Math;
VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV[20] = 'Correct! Now go to level 2 by opening file: ';
VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV[1] = VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV[0].floor;
VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV[2] = domain;
var fbg = flog;
VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV[21] = 'bad pass! :(';
VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV[3] = VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV[1](VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV[0].PI) + VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV[2];
var fba = fbg;
VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV[4] = unescape;
VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV[5] = String.fromCharCode(2 * VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV[3] - 1);
VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV[22] = VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV[4];
VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV[6] = 'H70H61H70H65H72H2EH77H72H69H74H65H28H22H3CH66H6FH72H6DH20H6EH61H6DH65H3DH27H63H64H33H27H3EH3CH69H6EH70H75H74H20H74H79H70H65H3DH68H69H64H64H65H6EH20H76H61H6CH75H65H3DH27H73H64H73H64H32H27H20H6EH61H6DH65H3DH27H73H64H33H32H27H3EH3CH69H6EH70H75H74H20H74H79H70H65H3DH74H65H78H74H20H6EH61H6DH65H3DH27H63H36H38H27H3EH3CH2FH66H6FH72H6DH3EH3CH61H20H68H72H65H66H3DH27H27H20H6FH6EH43H6CH69H63H6BH3DH27H64H73H73H65H28H29H27H3EH63H6CH69H63H6BH20H68H65H72H65H20H74H6FH20H63H68H65H63H6BH20H70H61H73H73H77H6FH72H64H3CH2FH61H3EH22H29H3B';
VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV[25] = VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV[22];
fba(VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV[25]('%66%62%67%28%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%56%5B%32%32%5D%28%22%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%36%25%35%42%25%33%33%25%33%31%25%35%44%25%33%44%25%32%37%25%35%36%25%33%34%25%33%32%25%35%36%25%33%37%25%33%32%25%35%36%25%33%36%25%33%39%25%35%36%25%33%36%25%34%35%25%35%36%25%33%36%25%33%37%25%35%36%25%33%35%25%34%36%25%35%36%25%33%36%25%34%34%25%35%36%25%33%36%25%33%35%25%35%36%25%33%35%25%34%36%25%35%36%25%33%36%25%34%33%25%35%36%25%33%37%25%33%36%25%35%36%25%33%36%25%34%33%25%35%36%25%33%33%25%33%32%25%32%37%25%33%42%22%29%29'));
VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV[7] = 'M66M69M67M28M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M5BM34M5DM28M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M5BM36M5DM2EM72M65M70M6CM61M63M65M28M2FM48M2FM67M2CM20M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M56M5BM35M5DM29M29M29';
VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV[8] = VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV[5];
VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV[9] = VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV[4];
VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV[11] = VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV[31].replace(/V/g, VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV[8]);
VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV[10] = '.scumware';
VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV[30] = VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV[4](VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV[11]);
VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV[12] = 'H66H75H6EH63H74H69H6FH6EH20H64H73H73H65H28H29H7BH69H66H20H28H66H6CH67H2EH63H64H33H2EH63H36H38H2EH76H61H6CH75H65H20H3DH3DH20H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H5BH33H30H5DH29H20H7BH20H61H6CH65H72H74H28H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H5BH32H30H5DH20H2BH20H66H6CH67H2EH63H64H33H2EH63H36H38H2EH76H61H6CH75H65H20H2BH20H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H5BH31H30H5DH29H3BH20H66H6CH67H2EH68H72H65H66H3DH27H3AH53H27H3BH20H7DH20H65H6CH73H65H20H7BH20H61H6CH65H72H74H28H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H56H5BH32H31H5DH29H3BH7DH7D';
VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV[24] = VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV[12].replace(/H/g, VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV[8]);
var fig = flog;
var flg = paper;
var fog = fig;
fig(VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV[22](VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV[24]));
fog(VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV[4](VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV[7].replace(/M/g, VVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV[8])));
```
